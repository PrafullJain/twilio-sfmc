<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge" />

    <title>TESTING: Custom Journey Builder Activity</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
    <script src="https://cdn.tiny.cloud/1/8zy98iygd3ouqncc5mhw6f5n3jj15f3xeikmeum4izpkw3mw/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>
    
   <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    
    
    <link rel="stylesheet" type="text/css" href="/assets/styles/salesforce-lightning-design-system.css" />
    
    <script>
    tinymce.init({
      selector: '#mytextarea'
    });
  </script>
    
    
   
    <script type="text/javascript">
        (function() {
            var config = {
                baseUrl: 'js'
            };

            var dependencies = [
                'customActivity'
            ];

            require(config, dependencies);
        })();
    </script>
    
    
    <style type="text/css">
        body {
            padding: 20px;
            margin: 0;
	    background-color: #ffffff;
        }
        .step {
            display: none;
        }
        #step1 {
            display: block;
        }
	html{
		background: #ffffff;
	    }
        
        
        
        .editor
        {
			border:solid 1px #ccc;
			padding: 20px;
			min-height:200px;
        }

        .sample-toolbar
        {
			border:solid 1px #ddd;
			background:#f4f4f4;
			padding: 5px;
			border-radius:3px;
        }

        .sample-toolbar > span
        {
			cursor:pointer;
		}

        .sample-toolbar > span:hover
        {
			text-decoration:underline;
		}
	    
	    
	    
	    .insertatcaretactive
{
border:1px soild #1e90ff;
}
    </style>
</head>

<body>
    <div id="step1" class="step">
	    <div class="slds-text-heading_small instruction">Enter authentication values for twilio.</div>
       
        <br>
        <!--<div class="form-group">
            <div><label for="messageBody">Create message body:</label></div>
            <input class="form-control" id="messageBody" type="text" name="messageBody" value="">
        </div> -->
        <div class="form-group">
        <input class="form-control" id="messagingService" type="hidden" name="messagingService" value="">
             </div>
        <div class="form-group">
            <div><label for="accountSID">Account SID:</label></div>
            <input class="form-control" id="accountSID" type="text" name="accountSID" value="">
        </div>
        <div class="form-group">
            <div><label for="authToken">Auth Token:</label></div>
            <input class="form-control" id="authToken" type="text" name="authToken" value="">
        </div> 
</div>
    
<div id="step2" class="step">
<div class="slds-text-heading_small instruction">Select channels. The user will be sent messages only on the channel you are selecting.</div>
  <br><br>
  <!--  <input type="checkbox" id="SMS" name="SMS" value="SMS">
    <label for="SMS">Send SMS</label><br>
    <input type="checkbox" id="WhatsappSMS" name="WhatsappSMS" value="Whatsapp SMS">
    <label for="WhatsappSMS">Whatsapp SMS</label><br>-->
    
	
	<div class="slds-form-element">
  <div class="slds-form-element__control">
    <div class="slds-checkbox">
      <input type="checkbox" name="options" id="SMS" value=""  />
      <label class="slds-checkbox__label" for="SMS">
        <span class="slds-checkbox_faux"></span>
        <span class="slds-form-element__label">SMS</span>
      </label>
    </div>
  </div>
</div>
 
	
	
	<div class="slds-form-element">
  <div class="slds-form-element__control">
    <div class="slds-checkbox">
      <input type="checkbox" name="options" id="WhatsApp" value="" />
      <label class="slds-checkbox__label" for="WhatsApp">
        <span class="slds-checkbox_faux"></span>
        <span class="slds-form-element__label">WhatsApp</span>
      </label>
    </div>
  </div>
</div>
	
<!--	<span class="slds-checkbox"><input type="checkbox" id="H1D9-3ijP" value="on"><label class="slds-checkbox__label" for="H1D9-3ijP"><span class="slds-checkbox--faux"></span><span class="slds-form-element__label">Is Created</span>
</label></span>-->
    
</div>
<div id="step3" class="step">
<div class="slds-text-heading_small instruction">Create a message:</div>

    <br><br>
    <div class="sample-toolbar">
		<a href="javascript:void(0)" onclick="format('bold')"><span class="fa fa-bold fa-fw"></span></a>
		<a href="javascript:void(0)" onclick="format('italic')"><span class="fa fa-italic fa-fw"></span></a>
		<a href="javascript:void(0)" onclick="format('insertunorderedlist')"><span class="fa fa-list fa-fw"></span></a>
	    <div class="slds-form-element">
		  
		  <div class="slds-form-element__control">
		    <div class="slds-select_container">
		      <select class="slds-select">
			
			<option value="{{Contact.Default.EmailAddress}}" id="ps">Email</option>
			<option value="{{Contact.Attribute.TwilioV1.TwilioNumber}}">Phone number</option>
			
		      </select>
		    </div>
		  </div>
		</div>
	    <div class="dropdown btn-group">
	    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">P<span class="fuelux-icon fuelux-icon-person"></span><span class="caret"></span></button>
             <ul class="dropdown-menu" role="menu">
             <li><a href="javascript:void(0)" onclick="setTextToCurrentPos(value)" value="{{Contact.Default.EmailAddress}}">Email</a></li>
             <li><a href="javascript:void(0)" onclick="setTextToCurrentPos(value)" value="{{Contact.Attribute.TwilioV1.TwilioNumber}}">Phone number</a></li>
             
            </ul>
      	</div>		    
	     <!--    <select id="ps" onclick="setTextToCurrentPos()">
			<optgroup label="Primary Attributes" disabled>
			<option value="">personalization string</option>
			<option value="{{Contact.Default.EmailAddress}}">{{Contact.Default.EmailAddress}}</option>
			<option value="{{Contact.Attribute.TwilioV1.TwilioNumber}}">{{Contact.Default.EmailAddress}}</option>
	        </select>
	   <textarea rows="4" 
                  id="text1" 
                  cols="50"> 
      </textarea> 
        <input type="text" 
               id="insert" /> 
        <button onclick="setTextToCurrentPos()"> 
          Insert at current position 
      </button> -->
	    
		<!-- <a href="javascript:void(0)" onclick="setUrl()"><span class="fa fa-link fa-fw"></span></a>
		<span><input id="txtFormatUrl" placeholder="url" class="form-control"></span> -->
</div>

<div id="sampleeditor" class="editor" contenteditable='true'></div>
<input type="text" id="txtInput"  />	
    <button id="test">Insert "Test" at Cursor position</button>
	<script>
		//window.addEventListener('load', function(){
		//	document.getElementById('sampleeditor').setAttribute('contenteditable', 'true');
			
       // });

		function format(command, value) {
			document.execCommand(command, false, value);
		}

		/*function setUrl() {
			var url = document.getElementById('txtFormatUrl').value;
			var sText = document.getSelection();
			document.execCommand('insertHTML', false, '<a href="' + url + '" target="_blank">' + sText + '</a>');
			document.getElementById('txtFormatUrl').value = '';
		}*/
		

		
		/*function setTextToCurrentPos() { 
                var curPos =  5;
		var cur = getCaretIndex('sampleeditor');	
			//console.log("Cursor position 2  ----------------------------->" + cur); 
 		//var cur = document.getElementById('sampleeditor').innerHTML.selectionStart; 
			console.log("Cursor position 2  ----------------------------->" + cur); 
                console.log("Cursor position ----------------------------->" + curPos); 
                let text_area_val = document.getElementById('sampleeditor').innerHTML ;
			console.log("Value of text_area_val is------------------------->" + text_area_val);
                let text_to_insert = $("#ps").val(); 
			console.log("Value of text_to_insert is------------------------->" + text_to_insert);
			document.getElementById('sampleeditor').innerHTML = text_area_val.slice(0, curPos) + text_to_insert + text_area_val.slice(curPos);
			console.log("Value inserted is ---------------------------->" + text_area_val.slice(0, curPos) + text_to_insert + text_area_val.slice(curPos));
               // $("#sampleeditor").val(x.slice(0, curPos) + text_to_insert + x.slice(curPos)); 
            } */
	$.fn.EnableInsertAtCaret = function() {
$(this).on("focus", function() {        $(".insertatcaretactive").removeClass("insertatcaretactive");
     $(this).addClass("insertatcaretactive");
});
};	
	
	function InsertAtCaret(myvalue) {
         //  var myValue = $("#ps").val();
         // console.log("cursor position------------>" + myValue);
           console.log("<---------We are inside the insert js code-------->");
        if (document.selection) {
            //For browsers like Internet Explorer
            this.focus();
            sel = document.selection.createRange();
            sel.text = myValue;
            this.focus();
        } else if (this.selectionStart || this.selectionStart == '0') {
            //For browsers like Firefox and Webkit based
            var startPos = this.selectionStart;
            var endPos = this.selectionEnd;
            var scrollTop = this.scrollTop;
            this.value = this.value.substring(0, startPos) + myValue + this.value.substring(endPos, this.value.length);
            this.focus();
            this.selectionStart = startPos + myValue.length;
            this.selectionEnd = startPos + myValue.length;
            this.scrollTop = scrollTop;
        } else {
            this.value += myValue;
		console.log("my value------>" + this.value);
            this.focus();
        }
	
}	
		$("#sampleeditor,#txtInput").EnableInsertAtCaret();
		
          
		$('#ps').click(function() {
    InsertAtCaret('test');
});
		$('#test').click(function() {
    InsertAtCaret('test');
});

</script>	
	
	
<!-- Lightning text editor -->	
	
<!--	<div class="demo-only" style="min-height:180px">
<div class="slds-form-element">
<div class="slds-form-element__control">
<div class="slds-rich-text-editor slds-grid slds-grid_vertical slds-nowrap">
<div role="toolbar" class="slds-rich-text-editor__toolbar slds-shrink-none">
<ul aria-label="Format text" class="slds-button-group-list">
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="0">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#bold"></use>
</svg>
<span class="slds-assistive-text">Bold</span>
</button>
</li>
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#italic"></use>
</svg>
<span class="slds-assistive-text">Italic</span>
</button>
</li>
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#underline"></use>
</svg>
<span class="slds-assistive-text">Underline</span>
</button>
</li>
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#strikethrough"></use>
</svg>
<span class="slds-assistive-text">Strike Through</span>
</button>
</li>
</ul>
<ul aria-label="Format body" class="slds-button-group-list">
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#richtextbulletedlist"></use>
</svg>
<span class="slds-assistive-text">Bulleted List</span>
</button>
</li>
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#richtextnumberedlist"></use>
</svg>
<span class="slds-assistive-text">Numbered List</span>
</button>
</li>
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#richtextindent"></use>
</svg>
<span class="slds-assistive-text">Indent</span>
</button>
</li>
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#richtextoutdent"></use>
</svg>
<span class="slds-assistive-text">Outdent</span>
</button>
</li>
</ul>
<ul aria-label="Align text" class="slds-button-group-list">
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#left_align_text"></use>
</svg>
<span class="slds-assistive-text">Left Align Text</span>
</button>
</li>
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#center_align_text"></use>
</svg>
<span class="slds-assistive-text">Center Align Text</span>
</button>
</li>
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#right_align_text"></use>
</svg>
<span class="slds-assistive-text">Right Align Text</span>
</button>
</li>
</ul>
<ul aria-label="Insert content" class="slds-button-group-list">
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#emoji"></use>
</svg>
<span class="slds-assistive-text">Add Emoji</span>
</button>
</li>
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#image"></use>
</svg>
<span class="slds-assistive-text">Add Image</span>
</button>
</li>
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#link"></use>
</svg>
<span class="slds-assistive-text">Add Link</span>
</button>
</li>
</ul>
<ul aria-label="Add user" class="slds-button-group-list">
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#adduser"></use>
</svg>
<span class="slds-assistive-text">Add User</span>
</button>
</li>
</ul>
<ul aria-label="Remove Formatting" class="slds-button-group-list">
<li>
<button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1">
<svg class="slds-button__icon" aria-hidden="true">
<use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#remove_formatting"></use>
</svg>
<span class="slds-assistive-text">Remove Formatting</span>
</button>
</li>
</ul>
</div>
<div class="slds-rich-text-editor__textarea slds-grid">
<div aria-label="Post to feed" contenteditable="true" class="slds-rich-text-area__content slds-text-color_weak slds-grow">Post to feed...</div>
</div>
</div>
</div>
</div>
</div> -->	
    
    
   <!-- <div>
    <div>
        <textarea class="form-control" id="messageBody" type="text" name="messageBody" value="">
    </div>
    <script src="https://cdn.ckeditor.com/4.13.0/standard/ckeditor.js"></script>
    <script>
       CKEDITOR.replace( 'messageBody' );
    </script>
    </div>-->
</div>
	
	
<div id="step4" class="step">
 <div class="slds-text-heading_small instruction">CHANNEL</div> 
<br> <br>
 <div class="slds-text-heading_small instruction">MESSAGE BODY</div> 
</div>
	
	
</body>
</html>
